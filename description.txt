
 



The class calculates the importance of features based on the Shaplibrary for a classification problem.
  Only works with trees for better efficiency or models based on
  gradient boosting. It is a priority to use such models as:
   
   Catboost - does not require handling of NaN and categories. works with sklearn

  you need to import:

    from sklearn.base import BaseEstimator, TransformerMixin
    import shap

  Parametrs. 

    estimator:   
        Supervised learning with the fit method will allow you to retrieve and select indices.
        the most important signs.
    n_features_to_select: int, default = None.
        The number of features to select, the default is None.
    columns: List, default = None.
        The list of attributes of the initial set, the default is None.
    
  Methods

    fit - trains and identifies the most important signs
    tranform - changes the original set and returns the selected attributes
    get_index - Returns the selected indexes attributes
    plot_values - plotting shap values
    _estimator_type - @property method - returns the type of the model
    get_feature_importance - Returns DataFrame FI
  Note

 Nan / Inf are allowed in case
    they are accepted by the fit method model
  Example use for classification

    cols = list(X_train.columns)
    cat_features = list(X_train_cat.select_dtypes(include=['object', 'category']).columns)
    num_features = list(X_train_cat.select_dtypes(exclude=['object', 'category']).columns)
    estimator = CatBoostClassifier(**params_cat)
    selector = ShapFeatureSelection(estimator, n_features_to_select=3, columns=cols) 
    preprocessor = ColumnTransformer (
        transformers = [

            ('std_scaler' , StandardScaler() , num_features) ,
            ('cat' , OrdinalEncoder() , cat_features),
            
            
            ]
    )

    pipe = Pipeline(steps=
        
        [ 
          ('preprocessor', preprocessor),
          ('selector', selector)

        ]
    )
       X_train_prep = pipe.fit_transform(X_train)
       
Example without Pipeline

       cols = list(X_train.columns)
       estimator = CatBoostClassifier(**params_cat)
       selector = ShapFeatureSelection(estimator, n_features_to_select=3, columns=cols)
       X = selector.fit(X_train_prep, y_train)

